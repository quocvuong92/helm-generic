# =============================================================================
# GENERIC HELM CHART v2.0
# A flexible, generic Helm chart for deploying any containerized application
# =============================================================================

# =============================================================================
# WORKLOAD CONFIGURATION
# =============================================================================
workload:
  # -- Workload type: deployment, statefulset, daemonset, or cronjob
  type: deployment
  # -- Number of replicas (ignored for daemonset and cronjob)
  replicas: 1

  # -- Deployment-specific settings (only used when type: deployment)
  deployment:
    strategy:
      type: RollingUpdate
      rollingUpdate:
        maxSurge: 25%
        maxUnavailable: 25%

  # -- StatefulSet-specific settings (only used when type: statefulset)
  statefulset:
    # -- Service name for StatefulSet (defaults to fullname if empty)
    serviceName: ""
    # -- Pod management policy: OrderedReady or Parallel
    podManagementPolicy: OrderedReady
    # -- Update strategy for StatefulSet
    updateStrategy:
      type: RollingUpdate
    # -- Volume claim templates for StatefulSet
    volumeClaimTemplates: []
      # - name: data
      #   accessModes: ["ReadWriteOnce"]
      #   size: 10Gi
      #   storageClassName: ""

  # -- DaemonSet-specific settings (only used when type: daemonset)
  daemonset:
    # -- Update strategy for DaemonSet
    updateStrategy:
      type: RollingUpdate
      rollingUpdate:
        maxUnavailable: 1

  # -- CronJob-specific settings (only used when type: cronjob)
  cronjob:
    # -- Cron schedule expression
    schedule: "0 * * * *"
    # -- Timezone for schedule (requires K8s >= 1.27)
    timeZone: ""
    # -- Concurrency policy: Allow, Forbid, or Replace
    concurrencyPolicy: Forbid
    # -- Number of successful jobs to retain
    successfulJobsHistoryLimit: 3
    # -- Number of failed jobs to retain
    failedJobsHistoryLimit: 1
    # -- Restart policy for pods: OnFailure or Never
    restartPolicy: OnFailure

# =============================================================================
# CONTAINER CONFIGURATION
# =============================================================================
image:
  # -- Container image repository
  repository: nginx
  # -- Container image tag (defaults to Chart.appVersion if empty)
  tag: ""
  # -- Image pull policy: Always, IfNotPresent, or Never
  pullPolicy: IfNotPresent

# -- Image pull secrets for private registries
imagePullSecrets: []
  # - name: my-registry-secret

# -- Override container command (entrypoint)
command: []

# -- Override container args
args: []

# -- Environment variables for the main container
env: []
  # - name: MY_VAR
  #   value: "my-value"
  # - name: POD_NAME
  #   valueFrom:
  #     fieldRef:
  #       fieldPath: metadata.name

# -- Load environment from existing ConfigMaps or Secrets
envFrom: []
  # - configMapRef:
  #     name: my-configmap
  # - secretRef:
  #     name: my-secret

# -- Secret environment variables (creates Secret and injects as env vars). Values are templated.
secretEnv: []
  # - name: DB_PASSWORD
  #   value: "secret-value"

# -- Container ports configuration
ports:
  - name: http
    containerPort: 80
    protocol: TCP

# -- Resource limits and requests
resources: {}
  # limits:
  #   cpu: 100m
  #   memory: 128Mi
  # requests:
  #   cpu: 100m
  #   memory: 128Mi

# -- Security context for the main container
securityContext: {}
  # runAsNonRoot: true
  # runAsUser: 1000
  # readOnlyRootFilesystem: true

# -- Liveness probe configuration
livenessProbe: {}

# -- Readiness probe configuration
readinessProbe: {}

# -- Startup probe configuration
startupProbe: {}

# =============================================================================
# POD CONFIGURATION
# =============================================================================
pod:
  # -- Additional annotations for pods
  annotations: {}
  # -- Additional labels for pods
  labels: {}
  # -- Pod-level security context
  securityContext: {}
  # -- Node selector for pod scheduling
  nodeSelector: {}
  # -- Tolerations for pod scheduling
  tolerations: []
  # -- Affinity rules for pod scheduling
  affinity: {}
  # -- Topology spread constraints
  topologySpreadConstraints: []
  # -- DNS policy: ClusterFirst, ClusterFirstWithHostNet, Default, or None
  dnsPolicy: ClusterFirst
  # -- Custom DNS configuration
  dnsConfig: {}
  # -- Termination grace period in seconds
  terminationGracePeriodSeconds: 30
  # -- Init containers to run before main container
  initContainers: []
  # -- Sidecar containers running alongside main container
  sidecars: []
  # -- Additional volumes (beyond configFiles/secretFiles/storage)
  volumes: []
  # -- Additional volume mounts for main container
  volumeMounts: []

# =============================================================================
# SERVICE ACCOUNT
# =============================================================================
serviceAccount:
  # -- Create a service account
  create: true
  # -- Service account name (defaults to fullname if empty)
  name: ""
  # -- Annotations for the service account (e.g., for IAM roles)
  annotations: {}
  # -- Automount API credentials into pods
  automountServiceAccountToken: true

# =============================================================================
# CONFIGURATION & SECRETS
# =============================================================================
# -- Config files to mount into pod (creates ConfigMap). Content is templated.
configFiles: []
  # - name: app-config
  #   mountPath: /etc/app/config.yaml
  #   content: |
  #     key: value

# -- Secret files to mount into pod (creates Secret). Content is templated.
secretFiles: []
  # - name: credentials
  #   mountPath: /etc/app/credentials.json
  #   content: |
  #     {"apiKey": "secret"}

# -- File mode for mounted config files (octal)
configFilesMode: 0644

# -- File mode for mounted secret files (octal)
secretFilesMode: 0640

# -- Restart pods automatically when configFiles or secretFiles change
restartOnConfigChange: true

# =============================================================================
# SERVICE & NETWORKING
# =============================================================================
service:
  # -- Enable Service creation
  enabled: true
  # -- Service type: ClusterIP, NodePort, LoadBalancer, or ExternalName
  type: ClusterIP
  # -- Service annotations
  annotations: {}
  # -- Service ports configuration
  ports:
    - name: http
      port: 80
      targetPort: 80
      protocol: TCP

ingress:
  # -- Enable Ingress
  enabled: false
  # -- Ingress class name
  className: ""
  # -- Ingress annotations
  annotations: {}
  # -- Ingress hosts configuration
  hosts: []
    # - host: example.com
    #   paths:
    #     - path: /
    #       pathType: Prefix
  # -- TLS configuration
  tls: []
    # - secretName: example-tls
    #   hosts:
    #     - example.com

networkPolicy:
  # -- Enable NetworkPolicy
  enabled: false
  # -- NetworkPolicy annotations
  annotations: {}
  # -- Policy types to enforce
  policyTypes:
    - Ingress
    - Egress
  # -- Ingress rules
  ingress: []
  # -- Egress rules
  egress: []

# =============================================================================
# STORAGE
# =============================================================================
storage:
  # -- Enable persistent storage (creates PVC)
  enabled: false
  # -- PVC name (defaults to fullname-storage if empty)
  name: ""
  # -- Storage size
  size: 10Gi
  # -- Access modes for PVC
  accessModes:
    - ReadWriteOnce
  # -- Storage class name (empty = default)
  storageClassName: ""
  # -- Volume mode: Filesystem or Block
  volumeMode: Filesystem
  # -- Mount path in container
  mountPath: /data
  # -- SubPath within the volume to mount
  subPath: ""
  # -- PVC annotations
  annotations: {}
  # -- Retain PVC when helm release is deleted
  retainOnDelete: true
  # -- Label selector for binding to existing PV
  selector: {}

# =============================================================================
# AUTOSCALING
# =============================================================================
autoscaling:
  # -- Enable HorizontalPodAutoscaler (only for deployment/statefulset)
  enabled: false
  # -- HPA annotations
  annotations: {}
  # -- Minimum number of replicas
  minReplicas: 1
  # -- Maximum number of replicas
  maxReplicas: 10
  # -- Scaling metrics configuration
  metrics:
    cpu:
      # -- Enable CPU-based autoscaling
      enabled: true
      # -- Target CPU utilization percentage
      averageUtilization: 80
    memory:
      # -- Enable memory-based autoscaling
      enabled: false
      # -- Target memory utilization percentage
      averageUtilization: 80
    # -- Custom metrics for HPA
    custom: []
  # -- HPA scaling behavior configuration
  behavior: {}

# =============================================================================
# RELIABILITY
# =============================================================================
podDisruptionBudget:
  # -- Enable PodDisruptionBudget (not supported for cronjob)
  enabled: false
  # -- PDB annotations
  annotations: {}
  # -- Minimum available pods (number or percentage)
  minAvailable: 1
  # -- Maximum unavailable pods (use ONE of minAvailable or maxUnavailable)
  # maxUnavailable: 1

# =============================================================================
# RBAC
# =============================================================================
rbac:
  # -- Namespace-scoped roles (creates Role + RoleBinding for each)
  roles: []
    # - name: ""
    #   namespaces: []
    #   rules:
    #     - apiGroups: [""]
    #       resources: ["pods"]
    #       verbs: ["get", "list"]

  # -- Cluster-scoped role configuration
  clusterRole:
    # -- Enable ClusterRole creation
    enabled: false
    # -- ClusterRole name (defaults to fullname)
    name: ""
    # -- ClusterRole rules
    rules: []

# =============================================================================
# MONITORING
# =============================================================================
serviceMonitor:
  # -- Enable ServiceMonitor (requires Prometheus Operator)
  enabled: false
  # -- ServiceMonitor annotations
  annotations: {}
  # -- Additional labels for ServiceMonitor discovery
  labels: {}
  # -- Scrape interval
  interval: 30s
  # -- Scrape timeout
  scrapeTimeout: 10s
  # -- Metrics endpoint path
  path: /metrics
  # -- Override default endpoints configuration
  endpoints: []

# =============================================================================
# METADATA OVERRIDES
# =============================================================================
# -- Override chart name in resource names
nameOverride: ""
# -- Override full release name
fullnameOverride: ""
# -- Global annotations added to ALL resources
globalAnnotations: {}

# =============================================================================
# ESCAPE HATCH
# =============================================================================
# -- Extra Kubernetes objects to deploy (fully templated)
extraObjects: []
